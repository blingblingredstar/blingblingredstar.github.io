<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.1/css/all.min.css" integrity="sha256-Z1K5uhUaJXA7Ll0XrZ/0JhX4lAtZFpT6jkKrEDT0drU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"yoursite.com","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.14.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="IntroductionWhat this talk is Introduction to Abstract Syntax Trees Introduction to inspecting and traversing ASTs with ESLint and Babel  What this talk is not Deep dive into ASTs Publishing actual pl">
<meta property="og:type" content="article">
<meta property="og:title" content="Code Transformation and Linting with Abstract Syntax Trees">
<meta property="og:url" content="http://yoursite.com/2019/07/30/Code-Transformation-and-Linting-with-Abstract-Syntax-Trees/index.html">
<meta property="og:site_name" content="刘勇的博客">
<meta property="og:description" content="IntroductionWhat this talk is Introduction to Abstract Syntax Trees Introduction to inspecting and traversing ASTs with ESLint and Babel  What this talk is not Deep dive into ASTs Publishing actual pl">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2019-07-30T13:49:21.000Z">
<meta property="article:modified_time" content="2023-05-17T14:12:23.319Z">
<meta property="article:author" content="刘勇">
<meta property="article:tag" content="FrontEndMasters">
<meta property="article:tag" content="JavaScript">
<meta property="article:tag" content="AST">
<meta property="article:tag" content="Babel">
<meta property="article:tag" content="ESLint">
<meta property="article:tag" content="Codemods">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://yoursite.com/2019/07/30/Code-Transformation-and-Linting-with-Abstract-Syntax-Trees/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://yoursite.com/2019/07/30/Code-Transformation-and-Linting-with-Abstract-Syntax-Trees/","path":"2019/07/30/Code-Transformation-and-Linting-with-Abstract-Syntax-Trees/","title":"Code Transformation and Linting with Abstract Syntax Trees"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Code Transformation and Linting with Abstract Syntax Trees | 刘勇的博客</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">刘勇的博客</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Introduction"><span class="nav-number">1.</span> <span class="nav-text">Introduction</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#What-this-talk-is"><span class="nav-number">1.1.</span> <span class="nav-text">What this talk is</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#What-this-talk-is-not"><span class="nav-number">1.2.</span> <span class="nav-text">What this talk is not</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Setup"><span class="nav-number">1.3.</span> <span class="nav-text">Setup</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Abstract-Syntax-Trees"><span class="nav-number">2.</span> <span class="nav-text">Abstract Syntax Trees</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Example-of-Abstract-Syntax-Trees"><span class="nav-number">2.1.</span> <span class="nav-text">Example of Abstract Syntax Trees</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Introducing-Abstract-Syntax-Trees"><span class="nav-number">2.2.</span> <span class="nav-text">Introducing Abstract Syntax Trees</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#What-Is-an-AST"><span class="nav-number">2.2.1.</span> <span class="nav-text">What Is an AST</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Exploring-ASTs"><span class="nav-number">2.2.2.</span> <span class="nav-text">Exploring ASTs</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ESLint-Plugin-and-AST"><span class="nav-number">3.</span> <span class="nav-text">ESLint Plugin and AST</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Challenge-1-Making-a-Plugin"><span class="nav-number">3.1.</span> <span class="nav-text">Challenge 1: Making a Plugin</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Challenge-2-Adding-New-Methods"><span class="nav-number">3.2.</span> <span class="nav-text">Challenge 2: Adding New Methods</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Challenge-3-Schema-Property"><span class="nav-number">3.3.</span> <span class="nav-text">Challenge 3: Schema Property</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Challenge-4-Edge-Cases"><span class="nav-number">3.4.</span> <span class="nav-text">Challenge 4: Edge Cases</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Challenge-5-Applying-Fixes"><span class="nav-number">3.5.</span> <span class="nav-text">Challenge 5: Applying Fixes</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Babel-Plugin-amp-AST"><span class="nav-number">4.</span> <span class="nav-text">Babel Plugin &amp; AST</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Introducing-Babel-amp-AST"><span class="nav-number">4.1.</span> <span class="nav-text">Introducing Babel &amp; AST</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Challenge-6-Captains-Log"><span class="nav-number">4.2.</span> <span class="nav-text">Challenge 6: Captains Log</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Challenge-7-Prefixing"><span class="nav-number">4.3.</span> <span class="nav-text">Challenge 7: Prefixing</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Challenge-8-Arrow-Function"><span class="nav-number">4.4.</span> <span class="nav-text">Challenge 8: Arrow Function</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Challenge-9-Divide-Function"><span class="nav-number">4.5.</span> <span class="nav-text">Challenge 9: Divide Function</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Codemods-amp-AST"><span class="nav-number">5.</span> <span class="nav-text">Codemods &amp; AST</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Introducing-Codemods-and-AST"><span class="nav-number">5.1.</span> <span class="nav-text">Introducing Codemods and AST</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Challenge-10-Upgrade-Patterns"><span class="nav-number">5.2.</span> <span class="nav-text">Challenge 10: Upgrade Patterns</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Challenge-11-Swap-Out-Utillties"><span class="nav-number">5.3.</span> <span class="nav-text">Challenge 11: Swap Out Utillties</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="刘勇"
      src="https://avatars.githubusercontent.com/u/43870278?s=400&u=7e0e1bf1f3550a08fa79cb6368718793280eb5eb&v=4">
  <p class="site-author-name" itemprop="name">刘勇</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">98</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">150</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/blingblingredstar" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;blingblingredstar" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:564447023@qq.com" title="E-Mail → mailto:564447023@qq.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/30/Code-Transformation-and-Linting-with-Abstract-Syntax-Trees/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars.githubusercontent.com/u/43870278?s=400&u=7e0e1bf1f3550a08fa79cb6368718793280eb5eb&v=4">
      <meta itemprop="name" content="刘勇">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="刘勇的博客">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Code Transformation and Linting with Abstract Syntax Trees | 刘勇的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Code Transformation and Linting with Abstract Syntax Trees
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-07-30 21:49:21" itemprop="dateCreated datePublished" datetime="2019-07-30T21:49:21+08:00">2019-07-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-05-17 22:12:23" itemprop="dateModified" datetime="2023-05-17T22:12:23+08:00">2023-05-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><h3 id="What-this-talk-is"><a href="#What-this-talk-is" class="headerlink" title="What this talk is"></a>What this talk is</h3><ul>
<li>Introduction to Abstract Syntax Trees</li>
<li>Introduction to inspecting and traversing ASTs with ESLint and Babel</li>
</ul>
<h3 id="What-this-talk-is-not"><a href="#What-this-talk-is-not" class="headerlink" title="What this talk is not"></a>What this talk is not</h3><ul>
<li>Deep dive into ASTs</li>
<li>Publishing actual plugin packages<span id="more"></span></li>
</ul>
<h3 id="Setup"><a href="#Setup" class="headerlink" title="Setup"></a>Setup</h3><p><a target="_blank" rel="noopener" href="https://github.com/kentcdodds/asts-workshop#setup">https://github.com/kentcdodds/asts-workshop#setup</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/kentcdodds/asts-workshop.git</span><br><span class="line"><span class="built_in">cd</span> asts-workshop</span><br><span class="line">yarn run setup --silent</span><br><span class="line">node scripts/autofill-feedback-email.js YOUR_EMAIL@DOMAIN.COM</span><br><span class="line">git commit -am <span class="string">&quot;ready to go&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="Abstract-Syntax-Trees"><a href="#Abstract-Syntax-Trees" class="headerlink" title="Abstract Syntax Trees"></a>Abstract Syntax Trees</h2><h3 id="Example-of-Abstract-Syntax-Trees"><a href="#Example-of-Abstract-Syntax-Trees" class="headerlink" title="Example of Abstract Syntax Trees"></a>Example of Abstract Syntax Trees</h3><p>BABEL使用了AST来转化代码。</p>
<p>例如可以使用<code>babel-plugin-lodash</code>来转化文件</p>
<p><a target="_blank" rel="noopener" href="https://github.com/lodash/babel-plugin-lodash">babel-plugin-lodash  A simple transform to cherry-pick Lodash modules so you don’t have to.</a></p>
<ul>
<li>Example<ul>
<li>Transforms</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> _ <span class="keyword">from</span> <span class="string">&#x27;lodash&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; add &#125; <span class="keyword">from</span> <span class="string">&#x27;lodash/fp&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> addOne = <span class="title function_">add</span>(<span class="number">1</span>)</span><br><span class="line">_.<span class="title function_">map</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], addOne)</span><br></pre></td></tr></table></figure>

<ul>
<li>roughly to</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> _add <span class="keyword">from</span> <span class="string">&#x27;lodash/fp/add&#x27;</span></span><br><span class="line"><span class="keyword">import</span> _map <span class="keyword">from</span> <span class="string">&#x27;lodash/map&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> addOne = <span class="title function_">_add</span>(<span class="number">1</span>)</span><br><span class="line"><span class="title function_">_map</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], addOne)</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://github.com/yannickcr/eslint-plugin-react">eslint-plugin-react</a><br><a target="_blank" rel="noopener" href="https://github.com/nodesecurity/eslint-plugin-security">eslint-plugin-security</a><br><a target="_blank" rel="noopener" href="https://www.npmjs.com/package/eslint-plugin-jsx-a11y">eslint-plugin-jsx-a11y</a></p>
<h3 id="Introducing-Abstract-Syntax-Trees"><a href="#Introducing-Abstract-Syntax-Trees" class="headerlink" title="Introducing Abstract Syntax Trees"></a>Introducing Abstract Syntax Trees</h3><h4 id="What-Is-an-AST"><a href="#What-Is-an-AST" class="headerlink" title="What Is an AST"></a>What Is an AST</h4><p>Code for humans</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> uniqueRandomArray = <span class="built_in">require</span>(<span class="string">&#x27;unique-random-array&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> transformersNames = <span class="built_in">require</span>(<span class="string">&#x27;./transformers-names.json&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> getRandomItem = <span class="title function_">uniqueRandomArray</span>(transformersNames)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">all</span>: transformersNames,</span><br><span class="line">  <span class="attr">random</span>: random,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">random</span>(<span class="params">number</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (number === <span class="literal">undefined</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">getRandomItem</span>()</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> randomItems = []</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; number; i++) &#123;</span><br><span class="line">      randomItems.<span class="title function_">push</span>(<span class="title function_">getRandomItem</span>())</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> randomItems</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Code for computers</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;type&quot;</span>: <span class="string">&quot;File&quot;</span>,</span><br><span class="line">  <span class="string">&quot;start&quot;</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="string">&quot;end&quot;</span>: <span class="number">482</span>,</span><br><span class="line">  <span class="string">&quot;loc&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;start&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;line&quot;</span>: <span class="number">1</span>,</span><br><span class="line">      <span class="string">&quot;column&quot;</span>: <span class="number">0</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;end&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;line&quot;</span>: <span class="number">22</span>,</span><br><span class="line">      <span class="string">&quot;column&quot;</span>: <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;program&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;type&quot;</span>: <span class="string">&quot;Program&quot;</span>,</span><br><span class="line">    <span class="string">&quot;start&quot;</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="string">&quot;end&quot;</span>: <span class="number">482</span>,</span><br><span class="line">    <span class="string">&quot;loc&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;start&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;line&quot;</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="string">&quot;column&quot;</span>: <span class="number">0</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="string">&quot;end&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;line&quot;</span>: <span class="number">22</span>,</span><br><span class="line">        <span class="string">&quot;column&quot;</span>: <span class="number">0</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 等余下3000行</span></span><br></pre></td></tr></table></figure>

<h4 id="Exploring-ASTs"><a href="#Exploring-ASTs" class="headerlink" title="Exploring ASTs"></a>Exploring ASTs</h4><p><a target="_blank" rel="noopener" href="http://resources.jointjs.com/demos/rappid/apps/Ast/index.html">jointjs demo</a></p>
<p><a target="_blank" rel="noopener" href="http://astexplorer.net/#/gist/da1ffc9ca82e239419fee2af19222394/latest">astexplorer.net demo</a></p>
<h2 id="ESLint-Plugin-and-AST"><a href="#ESLint-Plugin-and-AST" class="headerlink" title="ESLint Plugin and AST"></a>ESLint Plugin and AST</h2><h3 id="Challenge-1-Making-a-Plugin"><a href="#Challenge-1-Making-a-Plugin" class="headerlink" title="Challenge 1: Making a Plugin"></a>Challenge 1: Making a Plugin</h3><p><code>npm start exercise.eslint.0</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// eslint exercise 0 (no-console)</span></span><br><span class="line"><span class="comment">// When you&#x27;re finished with this exercise, run</span></span><br><span class="line"><span class="comment">//   &quot;npm start exercise.eslint.1&quot;</span></span><br><span class="line"><span class="comment">//   to move on to the next exercise</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">meta</span>: &#123;</span><br><span class="line">    <span class="attr">docs</span>: &#123;</span><br><span class="line">      <span class="attr">description</span>: <span class="string">&#x27;Disallow use of console&#x27;</span>,</span><br><span class="line">      <span class="attr">category</span>: <span class="string">&#x27;Best practice&#x27;</span>,</span><br><span class="line">      <span class="attr">recommended</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// you&#x27;re going to need context :)</span></span><br><span class="line">  <span class="comment">// eslint-disable-next-line no-unused-vars</span></span><br><span class="line">  <span class="title function_">create</span>(<span class="params">context</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="title class_">Identifier</span>(node) &#123;</span><br><span class="line">        <span class="keyword">if</span> (node.<span class="property">name</span> !== <span class="string">&#x27;console&#x27;</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        context.<span class="title function_">report</span>(&#123;</span><br><span class="line">          node,</span><br><span class="line">          <span class="attr">message</span>: <span class="string">&#x27;Using console is not allowed&#x27;</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Challenge-2-Adding-New-Methods"><a href="#Challenge-2-Adding-New-Methods" class="headerlink" title="Challenge 2: Adding New Methods"></a>Challenge 2: Adding New Methods</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// eslint exercise 1 (no-console)</span></span><br><span class="line"><span class="comment">// When you&#x27;re finished with this exercise, run</span></span><br><span class="line"><span class="comment">//   &quot;npm start exercise.eslint.2&quot;</span></span><br><span class="line"><span class="comment">//   to move on to the next exercise</span></span><br><span class="line"><span class="keyword">const</span> disAllowedMethods = [<span class="string">&#x27;log&#x27;</span>, <span class="string">&#x27;info&#x27;</span>, <span class="string">&#x27;warn&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="title function_">create</span>(<span class="params">context</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="title class_">Identifier</span>(node) &#123;</span><br><span class="line">        <span class="keyword">const</span> isConsoleCall = <span class="title function_">looksLike</span>(node, &#123;</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&#x27;console&#x27;</span>,</span><br><span class="line">          <span class="attr">parent</span>: &#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&#x27;MemberExpression&#x27;</span>,</span><br><span class="line">            <span class="attr">parent</span>: &#123;<span class="attr">type</span>: <span class="string">&#x27;CallExpression&#x27;</span>&#125;,</span><br><span class="line">            <span class="attr">property</span>: &#123;</span><br><span class="line">              <span class="attr">name</span>: <span class="function"><span class="params">val</span> =&gt;</span> disAllowedMethods.<span class="title function_">includes</span>(val),</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">if</span> (isConsoleCall) &#123;</span><br><span class="line">          context.<span class="title function_">report</span>(&#123;</span><br><span class="line">            node,</span><br><span class="line">            <span class="attr">message</span>: <span class="string">&#x27;Using console is not allowed&#x27;</span>,</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">looksLike</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    a &amp;&amp;</span><br><span class="line">    b &amp;&amp;</span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">keys</span>(b).<span class="title function_">every</span>(<span class="function"><span class="params">bKey</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> bVal = b[bKey]</span><br><span class="line">      <span class="keyword">const</span> aVal = a[bKey]</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> bVal === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">bVal</span>(aVal)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">isPrimitive</span>(bVal) ? bVal === aVal : <span class="title function_">looksLike</span>(aVal, bVal)</span><br><span class="line">    &#125;)</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isPrimitive</span>(<span class="params">val</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> val == <span class="literal">null</span> || <span class="regexp">/^[sbn]/</span>.<span class="title function_">test</span>(<span class="keyword">typeof</span> val)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Challenge-3-Schema-Property"><a href="#Challenge-3-Schema-Property" class="headerlink" title="Challenge 3: Schema Property"></a>Challenge 3: Schema Property</h3><p><code>npm start exercise.eslint.2</code></p>
<p><code>npm start</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> disallowedMethods = [<span class="string">&#x27;log&#x27;</span>, <span class="string">&#x27;info&#x27;</span>, <span class="string">&#x27;warn&#x27;</span>, <span class="string">&#x27;error&#x27;</span>, <span class="string">&#x27;dir&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">meta</span>: &#123;</span><br><span class="line">    <span class="attr">schema</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;object&#x27;</span>,</span><br><span class="line">        <span class="attr">properties</span>: &#123;</span><br><span class="line">          <span class="attr">allowedMethods</span>: &#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&#x27;array&#x27;</span>,</span><br><span class="line">            <span class="attr">items</span>: &#123;</span><br><span class="line">              <span class="attr">enum</span>: [<span class="string">&#x27;log&#x27;</span>, <span class="string">&#x27;info&#x27;</span>, <span class="string">&#x27;warn&#x27;</span>, <span class="string">&#x27;error&#x27;</span>, <span class="string">&#x27;dir&#x27;</span>],</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">minItems</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="attr">uniqueItems</span>: <span class="literal">true</span>,</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">create</span>(<span class="params">context</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> config = context.<span class="property">options</span>[<span class="number">0</span>] || &#123;&#125;</span><br><span class="line">    <span class="keyword">const</span> allowedMethods = config.<span class="property">allowedMethods</span> || []</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="title class_">Identifier</span>(node) &#123;</span><br><span class="line">        <span class="keyword">if</span> (</span><br><span class="line">          !<span class="title function_">looksLike</span>(node, &#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;console&#x27;</span>,</span><br><span class="line">            <span class="attr">parent</span>: &#123;</span><br><span class="line">              <span class="attr">type</span>: <span class="string">&#x27;MemberExpression&#x27;</span>,</span><br><span class="line">              <span class="attr">parent</span>: &#123;<span class="attr">type</span>: <span class="string">&#x27;CallExpression&#x27;</span>&#125;,</span><br><span class="line">              <span class="attr">property</span>: &#123;</span><br><span class="line">                <span class="attr">name</span>: <span class="function"><span class="params">val</span> =&gt;</span></span><br><span class="line">                  !allowedMethods.<span class="title function_">includes</span>(val) &amp;&amp;</span><br><span class="line">                  disallowedMethods.<span class="title function_">includes</span>(val),</span><br><span class="line">              &#125;,</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;)</span><br><span class="line">        ) &#123;</span><br><span class="line">          <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        context.<span class="title function_">report</span>(&#123;</span><br><span class="line">          <span class="attr">node</span>: node.<span class="property">parent</span>.<span class="property">property</span>,</span><br><span class="line">          <span class="attr">message</span>: <span class="string">&#x27;Using console is not allowed&#x27;</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">looksLike</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    a &amp;&amp;</span><br><span class="line">    b &amp;&amp;</span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">keys</span>(b).<span class="title function_">every</span>(<span class="function"><span class="params">bKey</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> bVal = b[bKey]</span><br><span class="line">      <span class="keyword">const</span> aVal = a[bKey]</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> bVal === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">bVal</span>(aVal)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">isPrimitive</span>(bVal) ? bVal === aVal : <span class="title function_">looksLike</span>(aVal, bVal)</span><br><span class="line">    &#125;)</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isPrimitive</span>(<span class="params">val</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> val == <span class="literal">null</span> || <span class="regexp">/^[sbn]/</span>.<span class="title function_">test</span>(<span class="keyword">typeof</span> val)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Challenge-4-Edge-Cases"><a href="#Challenge-4-Edge-Cases" class="headerlink" title="Challenge 4: Edge Cases"></a>Challenge 4: Edge Cases</h3><p><code>npm start ex.es.3</code></p>
<p><code>npm start</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> disallowedMethods = [<span class="string">&#x27;log&#x27;</span>, <span class="string">&#x27;info&#x27;</span>, <span class="string">&#x27;warn&#x27;</span>, <span class="string">&#x27;error&#x27;</span>, <span class="string">&#x27;dir&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">meta</span>: &#123;</span><br><span class="line">    <span class="attr">docs</span>: &#123;</span><br><span class="line">      <span class="attr">description</span>: <span class="string">&#x27;Disallow use of console&#x27;</span>,</span><br><span class="line">      <span class="attr">category</span>: <span class="string">&#x27;Best Practices&#x27;</span>,</span><br><span class="line">      <span class="attr">recommended</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">schema</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;object&#x27;</span>,</span><br><span class="line">        <span class="attr">properties</span>: &#123;</span><br><span class="line">          <span class="attr">allowedMethods</span>: &#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&#x27;array&#x27;</span>,</span><br><span class="line">            <span class="attr">items</span>: &#123;</span><br><span class="line">              <span class="attr">enum</span>: [<span class="string">&#x27;log&#x27;</span>, <span class="string">&#x27;info&#x27;</span>, <span class="string">&#x27;warn&#x27;</span>, <span class="string">&#x27;error&#x27;</span>, <span class="string">&#x27;dir&#x27;</span>],</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">minItems</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="attr">uniqueItems</span>: <span class="literal">true</span>,</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">create</span>(<span class="params">context</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> config = context.<span class="property">options</span>[<span class="number">0</span>] || &#123;&#125;</span><br><span class="line">    <span class="keyword">const</span> allowedMethods = config.<span class="property">allowedMethods</span> || []</span><br><span class="line">    <span class="keyword">const</span> consoleUsage = []</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="title class_">Identifier</span>(node) &#123;</span><br><span class="line">        <span class="keyword">if</span> (node.<span class="property">name</span> !== <span class="string">&#x27;console&#x27;</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        consoleUsage.<span class="title function_">push</span>(node)</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="string">&#x27;Program:exit&#x27;</span>() &#123;</span><br><span class="line">        consoleUsage.<span class="title function_">forEach</span>(<span class="function"><span class="params">identifier</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (<span class="title function_">isDisallowedFunctionCall</span>(identifier)) &#123;</span><br><span class="line">            context.<span class="title function_">report</span>(&#123;</span><br><span class="line">              <span class="attr">node</span>: identifier.<span class="property">parent</span>.<span class="property">property</span>,</span><br><span class="line">              <span class="attr">message</span>: <span class="string">&#x27;Using console is not allowed&#x27;</span>,</span><br><span class="line">            &#125;)</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> variableDeclaratorParent = <span class="title function_">findParent</span>(</span><br><span class="line">              identifier,</span><br><span class="line">              <span class="function"><span class="params">parent</span> =&gt;</span> parent.<span class="property">type</span> === <span class="string">&#x27;VariableDeclarator&#x27;</span>,</span><br><span class="line">            )</span><br><span class="line">            <span class="keyword">if</span> (variableDeclaratorParent) &#123;</span><br><span class="line">              <span class="keyword">const</span> references = context</span><br><span class="line">                .<span class="title function_">getDeclaredVariables</span>(variableDeclaratorParent)[<span class="number">0</span>]</span><br><span class="line">                .<span class="property">references</span>.<span class="title function_">slice</span>(<span class="number">1</span>)</span><br><span class="line">              references.<span class="title function_">forEach</span>(<span class="function"><span class="params">reference</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (</span><br><span class="line">                  !<span class="title function_">looksLike</span>(reference, &#123;</span><br><span class="line">                    <span class="attr">identifier</span>: &#123;</span><br><span class="line">                      <span class="attr">parent</span>: &#123;</span><br><span class="line">                        <span class="attr">property</span>: isDisallowedFunctionCall,</span><br><span class="line">                      &#125;,</span><br><span class="line">                    &#125;,</span><br><span class="line">                  &#125;)</span><br><span class="line">                ) &#123;</span><br><span class="line">                  <span class="keyword">return</span></span><br><span class="line">                &#125;</span><br><span class="line">                context.<span class="title function_">report</span>(&#123;</span><br><span class="line">                  <span class="attr">node</span>: reference.<span class="property">identifier</span>.<span class="property">parent</span>.<span class="property">property</span>,</span><br><span class="line">                  <span class="attr">message</span>: <span class="string">&#x27;Using console is not allowed&#x27;</span>,</span><br><span class="line">                &#125;)</span><br><span class="line">              &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">isDisallowedFunctionCall</span>(<span class="params">identifier</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">looksLike</span>(identifier, &#123;</span><br><span class="line">        <span class="attr">parent</span>: &#123;</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&#x27;MemberExpression&#x27;</span>,</span><br><span class="line">          <span class="attr">parent</span>: &#123;<span class="attr">type</span>: <span class="string">&#x27;CallExpression&#x27;</span>&#125;,</span><br><span class="line">          <span class="attr">property</span>: &#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="function"><span class="params">val</span> =&gt;</span></span><br><span class="line">              !allowedMethods.<span class="title function_">includes</span>(val) &amp;&amp; disallowedMethods.<span class="title function_">includes</span>(val),</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">findParent</span>(<span class="params">node, test</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_">test</span>(node)) &#123;</span><br><span class="line">    <span class="keyword">return</span> node</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (node.<span class="property">parent</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">findParent</span>(node.<span class="property">parent</span>, test)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">looksLike</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    a &amp;&amp;</span><br><span class="line">    b &amp;&amp;</span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">keys</span>(b).<span class="title function_">every</span>(<span class="function"><span class="params">bKey</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> bVal = b[bKey]</span><br><span class="line">      <span class="keyword">const</span> aVal = a[bKey]</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> bVal === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">bVal</span>(aVal)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">isPrimitive</span>(bVal) ? bVal === aVal : <span class="title function_">looksLike</span>(aVal, bVal)</span><br><span class="line">    &#125;)</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isPrimitive</span>(<span class="params">val</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> val == <span class="literal">null</span> || <span class="regexp">/^[sbn]/</span>.<span class="title function_">test</span>(<span class="keyword">typeof</span> val)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Challenge-5-Applying-Fixes"><a href="#Challenge-5-Applying-Fixes" class="headerlink" title="Challenge 5: Applying Fixes"></a>Challenge 5: Applying Fixes</h3><p><code>npm start ex.es.4</code></p>
<p><code>npm start</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> disallowedMethods = [<span class="string">&#x27;log&#x27;</span>, <span class="string">&#x27;info&#x27;</span>, <span class="string">&#x27;warn&#x27;</span>, <span class="string">&#x27;error&#x27;</span>, <span class="string">&#x27;dir&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">meta</span>: &#123;</span><br><span class="line">    <span class="attr">docs</span>: &#123;</span><br><span class="line">      <span class="attr">description</span>: <span class="string">&#x27;Disallow use of console&#x27;</span>,</span><br><span class="line">      <span class="attr">category</span>: <span class="string">&#x27;Best Practices&#x27;</span>,</span><br><span class="line">      <span class="attr">recommended</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">fixable</span>: <span class="string">&#x27;code&#x27;</span>,</span><br><span class="line">    <span class="attr">schema</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;object&#x27;</span>,</span><br><span class="line">        <span class="attr">properties</span>: &#123;</span><br><span class="line">          <span class="attr">allowedMethods</span>: &#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&#x27;array&#x27;</span>,</span><br><span class="line">            <span class="attr">items</span>: &#123;</span><br><span class="line">              <span class="attr">enum</span>: [<span class="string">&#x27;log&#x27;</span>, <span class="string">&#x27;info&#x27;</span>, <span class="string">&#x27;warn&#x27;</span>, <span class="string">&#x27;error&#x27;</span>, <span class="string">&#x27;dir&#x27;</span>],</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">minItems</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="attr">uniqueItems</span>: <span class="literal">true</span>,</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">create</span>(<span class="params">context</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> config = context.<span class="property">options</span>[<span class="number">0</span>] || &#123;&#125;</span><br><span class="line">    <span class="keyword">const</span> allowedMethods = config.<span class="property">allowedMethods</span> || []</span><br><span class="line">    <span class="keyword">const</span> consoleUsage = []</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="title class_">Identifier</span>(node) &#123;</span><br><span class="line">        <span class="keyword">if</span> (node.<span class="property">name</span> !== <span class="string">&#x27;console&#x27;</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        consoleUsage.<span class="title function_">push</span>(node)</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="string">&#x27;Program:exit&#x27;</span>() &#123;</span><br><span class="line">        consoleUsage.<span class="title function_">forEach</span>(checkDeniedMethodUsage)</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">report</span>(<span class="params">property, consoleReference</span>) &#123;</span><br><span class="line">      context.<span class="title function_">report</span>(&#123;</span><br><span class="line">        <span class="attr">node</span>: property,</span><br><span class="line">        <span class="attr">message</span>: <span class="string">&#x27;Using console is not allowed&#x27;</span>,</span><br><span class="line">        <span class="title function_">fix</span>(<span class="params">fixer</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> (</span><br><span class="line">            consoleReference.<span class="property">name</span> === <span class="string">&#x27;console&#x27;</span> &amp;&amp;</span><br><span class="line">            fixer.<span class="title function_">replaceText</span>(consoleReference, <span class="string">&#x27;logger&#x27;</span>)</span><br><span class="line">          )</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">isDisallowedFunctionCall</span>(<span class="params">identifier</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">looksLike</span>(identifier, &#123;</span><br><span class="line">        <span class="attr">parent</span>: &#123;</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&#x27;MemberExpression&#x27;</span>,</span><br><span class="line">          <span class="attr">parent</span>: &#123;<span class="attr">type</span>: <span class="string">&#x27;CallExpression&#x27;</span>&#125;,</span><br><span class="line">          <span class="attr">property</span>: &#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="function"><span class="params">val</span> =&gt;</span></span><br><span class="line">              !allowedMethods.<span class="title function_">includes</span>(val) &amp;&amp; disallowedMethods.<span class="title function_">includes</span>(val),</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">checkDeniedMethodUsage</span>(<span class="params">identifier</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="title function_">isDisallowedFunctionCall</span>(identifier)) &#123;</span><br><span class="line">        <span class="title function_">report</span>(identifier.<span class="property">parent</span>.<span class="property">property</span>, identifier)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> variableDeclaratorParent = <span class="title function_">findParent</span>(</span><br><span class="line">          identifier,</span><br><span class="line">          <span class="function"><span class="params">parent</span> =&gt;</span> parent.<span class="property">type</span> === <span class="string">&#x27;VariableDeclarator&#x27;</span>,</span><br><span class="line">        )</span><br><span class="line">        <span class="keyword">if</span> (variableDeclaratorParent) &#123;</span><br><span class="line">          <span class="keyword">const</span> references = context</span><br><span class="line">            .<span class="title function_">getDeclaredVariables</span>(variableDeclaratorParent)[<span class="number">0</span>]</span><br><span class="line">            .<span class="property">references</span>.<span class="title function_">slice</span>(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">          references.<span class="title function_">forEach</span>(<span class="function"><span class="params">reference</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (</span><br><span class="line">              <span class="title function_">findParent</span>(</span><br><span class="line">                reference.<span class="property">identifier</span>,</span><br><span class="line">                <span class="function"><span class="params">parent</span> =&gt;</span> parent.<span class="property">type</span> === <span class="string">&#x27;VariableDeclarator&#x27;</span>,</span><br><span class="line">              )</span><br><span class="line">            ) &#123;</span><br><span class="line">              <span class="title function_">checkDeniedMethodUsage</span>(reference.<span class="property">identifier</span>)</span><br><span class="line"></span><br><span class="line">              <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (</span><br><span class="line">              !<span class="title function_">looksLike</span>(reference, &#123;</span><br><span class="line">                <span class="attr">identifier</span>: &#123;</span><br><span class="line">                  <span class="attr">parent</span>: &#123;</span><br><span class="line">                    <span class="attr">property</span>: isDisallowedFunctionCall,</span><br><span class="line">                  &#125;,</span><br><span class="line">                &#125;,</span><br><span class="line">              &#125;)</span><br><span class="line">            ) &#123;</span><br><span class="line">              <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="title function_">report</span>(reference.<span class="property">identifier</span>.<span class="property">parent</span>.<span class="property">property</span>, identifier)</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">findParent</span>(<span class="params">node, test</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_">test</span>(node)) &#123;</span><br><span class="line">    <span class="keyword">return</span> node</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (node.<span class="property">parent</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">findParent</span>(node.<span class="property">parent</span>, test)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">looksLike</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    a &amp;&amp;</span><br><span class="line">    b &amp;&amp;</span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">keys</span>(b).<span class="title function_">every</span>(<span class="function"><span class="params">bKey</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> bVal = b[bKey]</span><br><span class="line">      <span class="keyword">const</span> aVal = a[bKey]</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> bVal === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">bVal</span>(aVal)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">isPrimitive</span>(bVal) ? bVal === aVal : <span class="title function_">looksLike</span>(aVal, bVal)</span><br><span class="line">    &#125;)</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isPrimitive</span>(<span class="params">val</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> val == <span class="literal">null</span> || <span class="regexp">/^[sbn]/</span>.<span class="title function_">test</span>(<span class="keyword">typeof</span> val)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Babel-Plugin-amp-AST"><a href="#Babel-Plugin-amp-AST" class="headerlink" title="Babel Plugin &amp; AST"></a>Babel Plugin &amp; AST</h2><h3 id="Introducing-Babel-amp-AST"><a href="#Introducing-Babel-amp-AST" class="headerlink" title="Introducing Babel &amp; AST"></a>Introducing Babel &amp; AST</h3><p><a target="_blank" rel="noopener" href="https://astexplorer.net/#/gist/9fbfbf53b7d03a616321f4b53b5d52b0/latest">Babel Plugin</a></p>
<h3 id="Challenge-6-Captains-Log"><a href="#Challenge-6-Captains-Log" class="headerlink" title="Challenge 6: Captains Log"></a>Challenge 6: Captains Log</h3><p><code>npm start ex.ba.0</code></p>
<p><code>npm start</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// babel exercise 0 (captains-log)</span></span><br><span class="line"><span class="comment">// When you&#x27;re finished with this exercise, run</span></span><br><span class="line"><span class="comment">//   &quot;npm start exercise.babel.1&quot;</span></span><br><span class="line"><span class="comment">//   to move on to the next exercise</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* eslint no-unused-vars:0 */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span>(<span class="params">babel</span>) &#123;</span><br><span class="line">  <span class="comment">// I&#x27;m leavning this here for you because it&#x27;s handy :)</span></span><br><span class="line">  <span class="keyword">const</span> &#123;<span class="attr">types</span>: t&#125; = babel</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;captains-log&#x27;</span>,</span><br><span class="line">    <span class="attr">visitor</span>: &#123;</span><br><span class="line">      <span class="title class_">CallExpression</span>(path) &#123;</span><br><span class="line">        <span class="keyword">const</span> isConsoleCall = <span class="title function_">looksLike</span>(path, &#123;</span><br><span class="line">          <span class="attr">node</span>: &#123;</span><br><span class="line">            <span class="attr">callee</span>: &#123;</span><br><span class="line">              <span class="attr">type</span>: <span class="string">&#x27;MemberExpression&#x27;</span>,</span><br><span class="line">              <span class="attr">object</span>: &#123;</span><br><span class="line">                <span class="attr">name</span>: <span class="string">&#x27;console&#x27;</span>,</span><br><span class="line">              &#125;,</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!isConsoleCall) &#123;</span><br><span class="line">          <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> start = path.<span class="property">node</span>.<span class="property">loc</span>.<span class="property">start</span></span><br><span class="line">        path.<span class="property">node</span>.<span class="property">arguments</span>.<span class="title function_">unshift</span>(</span><br><span class="line">          t.<span class="title function_">stringLiteral</span>(<span class="string">`<span class="subst">$&#123;start.line&#125;</span>:<span class="subst">$&#123;start.column&#125;</span>`</span>),</span><br><span class="line">        )</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">looksLike</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    a &amp;&amp;</span><br><span class="line">    b &amp;&amp;</span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">keys</span>(b).<span class="title function_">every</span>(<span class="function"><span class="params">bKey</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> bVal = b[bKey]</span><br><span class="line">      <span class="keyword">const</span> aVal = a[bKey]</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> bVal === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">bVal</span>(aVal)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">isPrimitive</span>(bVal) ? bVal === aVal : <span class="title function_">looksLike</span>(aVal, bVal)</span><br><span class="line">    &#125;)</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isPrimitive</span>(<span class="params">val</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> val == <span class="literal">null</span> || <span class="regexp">/^[sbn]/</span>.<span class="title function_">test</span>(<span class="keyword">typeof</span> val)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Challenge-7-Prefixing"><a href="#Challenge-7-Prefixing" class="headerlink" title="Challenge 7: Prefixing"></a>Challenge 7: Prefixing</h3><p><code>npm start ex.ba.1</code></p>
<p><code>npm start</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// babel exercise 1 (captains-log)</span></span><br><span class="line"><span class="comment">// When you&#x27;re finished with this exercise, run</span></span><br><span class="line"><span class="comment">//   &quot;npm start exercise.babel.2&quot;</span></span><br><span class="line"><span class="comment">//   to move on to the next exercise</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span>(<span class="params">babel</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123;<span class="attr">types</span>: t&#125; = babel</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;captains-log&#x27;</span>,</span><br><span class="line">    <span class="attr">visitor</span>: &#123;</span><br><span class="line">      <span class="title class_">CallExpression</span>(path) &#123;</span><br><span class="line">        <span class="keyword">if</span> (</span><br><span class="line">          !<span class="title function_">looksLike</span>(path, &#123;</span><br><span class="line">            <span class="attr">node</span>: &#123;</span><br><span class="line">              <span class="attr">callee</span>: &#123;</span><br><span class="line">                <span class="attr">type</span>: <span class="string">&#x27;MemberExpression&#x27;</span>,</span><br><span class="line">                <span class="attr">object</span>: &#123;</span><br><span class="line">                  <span class="attr">name</span>: <span class="string">&#x27;console&#x27;</span>,</span><br><span class="line">                &#125;,</span><br><span class="line">              &#125;,</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;)</span><br><span class="line">        ) &#123;</span><br><span class="line">          <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> parentFunction = path.<span class="title function_">findParent</span>(t.<span class="property">isFunctionDeclaration</span>)</span><br><span class="line">        <span class="keyword">const</span> start = path.<span class="property">node</span>.<span class="property">loc</span>.<span class="property">start</span></span><br><span class="line">        <span class="keyword">let</span> prefix = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> (parentFunction) &#123;</span><br><span class="line">          prefix += <span class="string">`<span class="subst">$&#123;parentFunction.node.id.name&#125;</span> `</span></span><br><span class="line">        &#125;</span><br><span class="line">        prefix += <span class="string">`<span class="subst">$&#123;start.line&#125;</span>:<span class="subst">$&#123;start.column&#125;</span>`</span></span><br><span class="line">        path.<span class="property">node</span>.<span class="property">arguments</span>.<span class="title function_">unshift</span>(t.<span class="title function_">stringLiteral</span>(prefix))</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">looksLike</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    a &amp;&amp;</span><br><span class="line">    b &amp;&amp;</span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">keys</span>(b).<span class="title function_">every</span>(<span class="function"><span class="params">bKey</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> bVal = b[bKey]</span><br><span class="line">      <span class="keyword">const</span> aVal = a[bKey]</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> bVal === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">bVal</span>(aVal)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">isPrimitive</span>(bVal) ? bVal === aVal : <span class="title function_">looksLike</span>(aVal, bVal)</span><br><span class="line">    &#125;)</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isPrimitive</span>(<span class="params">val</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> val == <span class="literal">null</span> || <span class="regexp">/^[sbn]/</span>.<span class="title function_">test</span>(<span class="keyword">typeof</span> val)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Challenge-8-Arrow-Function"><a href="#Challenge-8-Arrow-Function" class="headerlink" title="Challenge 8: Arrow Function"></a>Challenge 8: Arrow Function</h3><p><code>npm start ex.ba.2</code></p>
<p><code>npm start</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// babel exercise 2 (captains-log)</span></span><br><span class="line"><span class="comment">// When you&#x27;re finished with this exercise, run</span></span><br><span class="line"><span class="comment">//   &quot;npm start exercise.babel.3&quot;</span></span><br><span class="line"><span class="comment">//   to move on to the next exercise</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span>(<span class="params">babel</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123;<span class="attr">types</span>: t&#125; = babel</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;captains-log&#x27;</span>,</span><br><span class="line">    <span class="attr">visitor</span>: &#123;</span><br><span class="line">      <span class="title class_">CallExpression</span>(path) &#123;</span><br><span class="line">        <span class="keyword">if</span> (</span><br><span class="line">          !<span class="title function_">looksLike</span>(path, &#123;</span><br><span class="line">            <span class="attr">node</span>: &#123;</span><br><span class="line">              <span class="attr">callee</span>: &#123;</span><br><span class="line">                <span class="attr">type</span>: <span class="string">&#x27;MemberExpression&#x27;</span>,</span><br><span class="line">                <span class="attr">object</span>: &#123;</span><br><span class="line">                  <span class="attr">name</span>: <span class="string">&#x27;console&#x27;</span>,</span><br><span class="line">                &#125;,</span><br><span class="line">              &#125;,</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;)</span><br><span class="line">        ) &#123;</span><br><span class="line">          <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> prefix = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">const</span> parentFunctionName = <span class="title function_">getFunctionName</span>(path)</span><br><span class="line">        <span class="keyword">if</span> (parentFunctionName) &#123;</span><br><span class="line">          prefix += parentFunctionName</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> start = path.<span class="property">node</span>.<span class="property">loc</span>.<span class="property">start</span></span><br><span class="line">        prefix += <span class="string">` <span class="subst">$&#123;start.line&#125;</span>:<span class="subst">$&#123;start.column&#125;</span>`</span></span><br><span class="line">        path.<span class="property">node</span>.<span class="property">arguments</span>.<span class="title function_">unshift</span>(t.<span class="title function_">stringLiteral</span>(prefix.<span class="title function_">trim</span>()))</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getFunctionName</span>(<span class="params">path</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> parentFunction = path.<span class="title function_">findParent</span>(</span><br><span class="line">    <span class="function"><span class="params">parent</span> =&gt;</span></span><br><span class="line">      parent.<span class="title function_">isFunctionDeclaration</span>() || parent.<span class="title function_">isArrowFunctionExpression</span>(),</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (parentFunction) &#123;</span><br><span class="line">    <span class="keyword">if</span> (</span><br><span class="line">      parentFunction.<span class="title function_">isArrowFunctionExpression</span>() &amp;&amp;</span><br><span class="line">      parentFunction.<span class="property">parentPath</span>.<span class="title function_">isVariableDeclarator</span>()</span><br><span class="line">    ) &#123;</span><br><span class="line">      <span class="keyword">return</span> parentFunction.<span class="property">parent</span>.<span class="property">id</span>.<span class="property">name</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> parentFunction.<span class="property">node</span>.<span class="property">id</span>.<span class="property">name</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">looksLike</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    a &amp;&amp;</span><br><span class="line">    b &amp;&amp;</span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">keys</span>(b).<span class="title function_">every</span>(<span class="function"><span class="params">bKey</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> bVal = b[bKey]</span><br><span class="line">      <span class="keyword">const</span> aVal = a[bKey]</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> bVal === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">bVal</span>(aVal)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">isPrimitive</span>(bVal) ? bVal === aVal : <span class="title function_">looksLike</span>(aVal, bVal)</span><br><span class="line">    &#125;)</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isPrimitive</span>(<span class="params">val</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> val == <span class="literal">null</span> || <span class="regexp">/^[sbn]/</span>.<span class="title function_">test</span>(<span class="keyword">typeof</span> val)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Challenge-9-Divide-Function"><a href="#Challenge-9-Divide-Function" class="headerlink" title="Challenge 9: Divide Function"></a>Challenge 9: Divide Function</h3><p><code>npm start ex.ba.3</code></p>
<p><code>npm start</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// babel exercise 3 (captains-log)</span></span><br><span class="line"><span class="comment">// When you&#x27;re finished with this exercise, run</span></span><br><span class="line"><span class="comment">//   &quot;npm start exercise.babel.4&quot;</span></span><br><span class="line"><span class="comment">//   to move on to the next exercise</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span>(<span class="params">babel</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123;<span class="attr">types</span>: t&#125; = babel</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;captains-log&#x27;</span>,</span><br><span class="line">    <span class="attr">visitor</span>: &#123;</span><br><span class="line">      <span class="title class_">CallExpression</span>(path) &#123;</span><br><span class="line">        <span class="keyword">if</span> (</span><br><span class="line">          !<span class="title function_">looksLike</span>(path, &#123;</span><br><span class="line">            <span class="attr">node</span>: &#123;</span><br><span class="line">              <span class="attr">callee</span>: &#123;</span><br><span class="line">                <span class="attr">type</span>: <span class="string">&#x27;MemberExpression&#x27;</span>,</span><br><span class="line">                <span class="attr">object</span>: &#123;</span><br><span class="line">                  <span class="attr">name</span>: <span class="string">&#x27;console&#x27;</span>,</span><br><span class="line">                &#125;,</span><br><span class="line">              &#125;,</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;)</span><br><span class="line">        ) &#123;</span><br><span class="line">          <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> prefix = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">const</span> functionName = <span class="title function_">getFunctionName</span>(path)</span><br><span class="line">        <span class="keyword">if</span> (functionName) &#123;</span><br><span class="line">          prefix += functionName</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> start = path.<span class="property">node</span>.<span class="property">loc</span>.<span class="property">start</span></span><br><span class="line">        prefix += <span class="string">` <span class="subst">$&#123;start.line&#125;</span>:<span class="subst">$&#123;start.column&#125;</span>`</span></span><br><span class="line">        path.<span class="property">node</span>.<span class="property">arguments</span>.<span class="title function_">unshift</span>(t.<span class="title function_">stringLiteral</span>(prefix.<span class="title function_">trim</span>()))</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">getFunctionName</span>(<span class="params">path</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> parentFunction = path.<span class="title function_">findParent</span>(<span class="function"><span class="params">parent</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        t.<span class="title function_">isFunctionDeclaration</span>(parent) ||</span><br><span class="line">        t.<span class="title function_">isArrowFunctionExpression</span>(parent) ||</span><br><span class="line">        t.<span class="title function_">isFunctionExpression</span>(parent)</span><br><span class="line">      )</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">if</span> (!parentFunction) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">looksLike</span>(parentFunction, &#123;<span class="attr">node</span>: &#123;<span class="attr">id</span>: t.<span class="property">isIdentifier</span>&#125;&#125;)) &#123;</span><br><span class="line">      <span class="keyword">return</span> parentFunction.<span class="property">node</span>.<span class="property">id</span>.<span class="property">name</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (t.<span class="title function_">isVariableDeclarator</span>(parentFunction.<span class="property">parent</span>)) &#123;</span><br><span class="line">      <span class="keyword">return</span> parentFunction.<span class="property">parent</span>.<span class="property">id</span>.<span class="property">name</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">looksLike</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    a &amp;&amp;</span><br><span class="line">    b &amp;&amp;</span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">keys</span>(b).<span class="title function_">every</span>(<span class="function"><span class="params">bKey</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> bVal = b[bKey]</span><br><span class="line">      <span class="keyword">const</span> aVal = a[bKey]</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> bVal === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">bVal</span>(aVal)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">isPrimitive</span>(bVal) ? bVal === aVal : <span class="title function_">looksLike</span>(aVal, bVal)</span><br><span class="line">    &#125;)</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isPrimitive</span>(<span class="params">val</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> val == <span class="literal">null</span> || <span class="regexp">/^[sbn]/</span>.<span class="title function_">test</span>(<span class="keyword">typeof</span> val)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Codemods-amp-AST"><a href="#Codemods-amp-AST" class="headerlink" title="Codemods &amp; AST"></a>Codemods &amp; AST</h2><h3 id="Introducing-Codemods-and-AST"><a href="#Introducing-Codemods-and-AST" class="headerlink" title="Introducing Codemods and AST"></a>Introducing Codemods and AST</h3><p><a target="_blank" rel="noopener" href="https://astexplorer.net/#/gist/e8ff56e9255ea78988194a79659a3b56/latest">demo</a></p>
<h3 id="Challenge-10-Upgrade-Patterns"><a href="#Challenge-10-Upgrade-Patterns" class="headerlink" title="Challenge 10: Upgrade Patterns"></a>Challenge 10: Upgrade Patterns</h3><p><code>npm start exercise.codemod.0</code></p>
<p><code>npm start</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// codemod exercise 0 (ymnn-jquery)</span></span><br><span class="line"><span class="comment">// When you&#x27;re finished with this exercise, run</span></span><br><span class="line"><span class="comment">//   &quot;npm start exercise.codemod.1&quot;</span></span><br><span class="line"><span class="comment">//   to move on to the next exercise</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* eslint no-unused-vars:0 */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span>(<span class="params">babel</span>) &#123;</span><br><span class="line">  <span class="comment">// I&#x27;m leavning this here for you because it&#x27;s handy :)</span></span><br><span class="line">  <span class="keyword">const</span> &#123;<span class="attr">types</span>: t, template&#125; = babel</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;ymnn-jquery&#x27;</span>,</span><br><span class="line">    <span class="attr">visitor</span>: &#123;</span><br><span class="line">      <span class="title class_">CallExpression</span>(path) &#123;</span><br><span class="line">        <span class="keyword">const</span> isJqueryCallExpression = <span class="title function_">looksLike</span>(path, &#123;</span><br><span class="line">          <span class="attr">node</span>: &#123;</span><br><span class="line">            <span class="attr">callee</span>: &#123;</span><br><span class="line">              <span class="attr">name</span>: <span class="string">&#x27;$&#x27;</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">parent</span>: &#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&#x27;MemberExpression&#x27;</span>,</span><br><span class="line">            <span class="attr">property</span>: &#123;</span><br><span class="line">              <span class="attr">name</span>: <span class="string">&#x27;hide&#x27;</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!isJqueryCallExpression) &#123;</span><br><span class="line">          <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> overallPath = path.<span class="property">parentPath</span>.<span class="property">parentPath</span></span><br><span class="line">        <span class="keyword">const</span> templateString = <span class="string">`EL.style.display = &#x27;none&#x27;`</span></span><br><span class="line">        <span class="keyword">const</span> assignmentBuilder = <span class="title function_">template</span>(templateString)</span><br><span class="line">        <span class="keyword">const</span> assignment = <span class="title function_">assignmentBuilder</span>(&#123;</span><br><span class="line">          <span class="attr">EL</span>: t.<span class="title function_">identifier</span>(path.<span class="property">node</span>.<span class="property">arguments</span>[<span class="number">0</span>].<span class="property">name</span>),</span><br><span class="line">        &#125;)</span><br><span class="line">        overallPath.<span class="title function_">replaceWith</span>(assignment)</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">looksLike</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    a &amp;&amp;</span><br><span class="line">    b &amp;&amp;</span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">keys</span>(b).<span class="title function_">every</span>(<span class="function"><span class="params">bKey</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> bVal = b[bKey]</span><br><span class="line">      <span class="keyword">const</span> aVal = a[bKey]</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> bVal === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">bVal</span>(aVal)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">isPrimitive</span>(bVal) ? bVal === aVal : <span class="title function_">looksLike</span>(aVal, bVal)</span><br><span class="line">    &#125;)</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isPrimitive</span>(<span class="params">val</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> val == <span class="literal">null</span> || <span class="regexp">/^[sbn]/</span>.<span class="title function_">test</span>(<span class="keyword">typeof</span> val)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Challenge-11-Swap-Out-Utillties"><a href="#Challenge-11-Swap-Out-Utillties" class="headerlink" title="Challenge 11: Swap Out Utillties"></a>Challenge 11: Swap Out Utillties</h3><p><code>npm start exercise.codemod.3</code></p>
<p><code>npm start</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span>(<span class="params">babel</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123;template, <span class="attr">types</span>: t&#125; = babel</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;ymnn-jquery&#x27;</span>,</span><br><span class="line">    <span class="attr">visitor</span>: &#123;</span><br><span class="line">      <span class="title class_">Program</span>: &#123;</span><br><span class="line">        <span class="title function_">enter</span>(<span class="params">path, &#123;file&#125;</span>) &#123;</span><br><span class="line">          file.<span class="title function_">set</span>(<span class="string">&#x27;assignedJQueryEls&#x27;</span>, <span class="keyword">new</span> <span class="title class_">Set</span>())</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="title function_">exit</span>(<span class="params">path, &#123;file&#125;</span>) &#123;</span><br><span class="line">          <span class="keyword">const</span> jQueryElVariableDeclarators = file.<span class="title function_">get</span>(<span class="string">&#x27;assignedJQueryEls&#x27;</span>)</span><br><span class="line">          <span class="title class_">Array</span>.<span class="title function_">from</span>(jQueryElVariableDeclarators).<span class="title function_">forEach</span>(</span><br><span class="line">            <span class="function"><span class="params">assignedCallExpression</span> =&gt;</span> &#123;</span><br><span class="line">              <span class="keyword">const</span> declaratorPath = assignedCallExpression.<span class="property">parentPath</span></span><br><span class="line">              <span class="keyword">const</span> binding = declaratorPath.<span class="property">scope</span>.<span class="title function_">getBinding</span>(</span><br><span class="line">                declaratorPath.<span class="property">node</span>.<span class="property">id</span>.<span class="property">name</span>,</span><br><span class="line">              )</span><br><span class="line">              binding.<span class="property">referencePaths</span>.<span class="title function_">forEach</span>(<span class="function"><span class="params">referencePath</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (</span><br><span class="line">                  <span class="title function_">looksLike</span>(referencePath, &#123;</span><br><span class="line">                    <span class="attr">parentPath</span>: &#123;</span><br><span class="line">                      <span class="attr">type</span>: <span class="string">&#x27;MemberExpression&#x27;</span>,</span><br><span class="line">                      <span class="attr">parentPath</span>: &#123;</span><br><span class="line">                        <span class="attr">type</span>: <span class="string">&#x27;CallExpression&#x27;</span>,</span><br><span class="line">                      &#125;,</span><br><span class="line">                    &#125;,</span><br><span class="line">                  &#125;)</span><br><span class="line">                ) &#123;</span><br><span class="line">                  <span class="keyword">if</span> (</span><br><span class="line">                    !<span class="title function_">isSupportedJQueryFunctionCall</span>(referencePath.<span class="property">parentPath</span>)</span><br><span class="line">                  ) &#123;</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                  &#125;</span><br><span class="line">                  <span class="keyword">const</span> [el] = assignedCallExpression.<span class="property">node</span>.<span class="property">arguments</span></span><br><span class="line">                  <span class="title function_">handleSupportedJQueryFunctionCall</span>(</span><br><span class="line">                    el,</span><br><span class="line">                    referencePath.<span class="property">parent</span>.<span class="property">property</span>.<span class="property">name</span>,</span><br><span class="line">                    referencePath.<span class="property">parentPath</span>.<span class="property">parentPath</span>,</span><br><span class="line">                  )</span><br><span class="line">                  declaratorPath.<span class="title function_">remove</span>()</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;)</span><br><span class="line">            &#125;,</span><br><span class="line">          )</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="title class_">CallExpression</span>(path, &#123;file&#125;) &#123;</span><br><span class="line">        <span class="keyword">if</span> (</span><br><span class="line">          !<span class="title function_">looksLike</span>(path, &#123;</span><br><span class="line">            <span class="attr">node</span>: &#123;</span><br><span class="line">              <span class="attr">callee</span>: &#123;<span class="attr">name</span>: <span class="string">&#x27;$&#x27;</span>&#125;,</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;)</span><br><span class="line">        ) &#123;</span><br><span class="line">          <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_">isSupportedJQueryFunctionCall</span>(path.<span class="property">parentPath</span>)) &#123;</span><br><span class="line">          <span class="keyword">if</span> (t.<span class="title function_">isVariableDeclarator</span>(path.<span class="property">parentPath</span>)) &#123;</span><br><span class="line">            file.<span class="title function_">get</span>(<span class="string">&#x27;assignedJQueryEls&#x27;</span>).<span class="title function_">add</span>(path)</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> jqueryFunction = path.<span class="property">parentPath</span>.<span class="property">node</span>.<span class="property">property</span>.<span class="property">name</span></span><br><span class="line">        <span class="keyword">const</span> pathToReplace = path.<span class="property">parentPath</span>.<span class="property">parentPath</span></span><br><span class="line">        <span class="keyword">const</span> [el] = path.<span class="property">node</span>.<span class="property">arguments</span></span><br><span class="line">        <span class="title function_">handleSupportedJQueryFunctionCall</span>(el, jqueryFunction, pathToReplace)</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">handleSupportedJQueryFunctionCall</span>(<span class="params"></span></span><br><span class="line"><span class="params">    el,</span></span><br><span class="line"><span class="params">    jqueryFunction,</span></span><br><span class="line"><span class="params">    pathToReplace,</span></span><br><span class="line"><span class="params">  </span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (jqueryFunction === <span class="string">&#x27;addClass&#x27;</span>) &#123;</span><br><span class="line">      <span class="title function_">updateAddClass</span>(el, pathToReplace)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_">updateDisplay</span>(el, pathToReplace, jqueryFunction)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">updateDisplay</span>(<span class="params">el, pathToReplace, jqueryFunction</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> templateString = <span class="string">`ELEMENT.style.display = DISPLAY;`</span></span><br><span class="line">    <span class="keyword">const</span> assignment = <span class="title function_">template</span>(templateString)(&#123;</span><br><span class="line">      <span class="attr">ELEMENT</span>: el,</span><br><span class="line">      <span class="attr">DISPLAY</span>: t.<span class="title function_">stringLiteral</span>(jqueryFunction === <span class="string">&#x27;show&#x27;</span> ? <span class="string">&#x27;&#x27;</span> : <span class="string">&#x27;none&#x27;</span>),</span><br><span class="line">    &#125;)</span><br><span class="line">    pathToReplace.<span class="title function_">replaceWith</span>(assignment)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">updateAddClass</span>(<span class="params">el, pathToReplace</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> templateString = <span class="string">`ELEMENT.classList.add(CLASS_NAME);`</span></span><br><span class="line">    <span class="keyword">const</span> assignment = <span class="title function_">template</span>(templateString)(&#123;</span><br><span class="line">      <span class="attr">ELEMENT</span>: el,</span><br><span class="line">      <span class="attr">CLASS_NAME</span>: pathToReplace.<span class="property">node</span>.<span class="property">arguments</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">    pathToReplace.<span class="title function_">replaceWith</span>(assignment)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isSupportedJQueryFunctionCall</span>(<span class="params">memberExpression</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">looksLike</span>(memberExpression, &#123;</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;callee&#x27;</span>,</span><br><span class="line">    <span class="attr">node</span>: &#123;</span><br><span class="line">      <span class="attr">property</span>: &#123;</span><br><span class="line">        <span class="attr">name</span>: <span class="function"><span class="params">val</span> =&gt;</span> [<span class="string">&#x27;hide&#x27;</span>, <span class="string">&#x27;show&#x27;</span>, <span class="string">&#x27;addClass&#x27;</span>].<span class="title function_">includes</span>(val),</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">looksLike</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    a &amp;&amp;</span><br><span class="line">    b &amp;&amp;</span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">keys</span>(b).<span class="title function_">every</span>(<span class="function"><span class="params">bKey</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> bVal = b[bKey]</span><br><span class="line">      <span class="keyword">const</span> aVal = a[bKey]</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> bVal === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">bVal</span>(aVal)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">isPrimitive</span>(bVal) ? bVal === aVal : <span class="title function_">looksLike</span>(aVal, bVal)</span><br><span class="line">    &#125;)</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isPrimitive</span>(<span class="params">val</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> val == <span class="literal">null</span> || <span class="regexp">/^[sbn]/</span>.<span class="title function_">test</span>(<span class="keyword">typeof</span> val)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/FrontEndMasters/" rel="tag"># FrontEndMasters</a>
              <a href="/tags/JavaScript/" rel="tag"># JavaScript</a>
              <a href="/tags/AST/" rel="tag"># AST</a>
              <a href="/tags/Babel/" rel="tag"># Babel</a>
              <a href="/tags/ESLint/" rel="tag"># ESLint</a>
              <a href="/tags/Codemods/" rel="tag"># Codemods</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2019/07/25/JavaScript-Performance/" rel="prev" title="JavaScript Performance">
                  <i class="fa fa-chevron-left"></i> JavaScript Performance
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2019/08/05/TypeScript-3-Fundamentals-v2/" rel="next" title="TypeScript 3 Fundamentals v2">
                  TypeScript 3 Fundamentals v2 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">刘勇</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  




  





</body>
</html>
